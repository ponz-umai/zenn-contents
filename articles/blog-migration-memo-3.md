---
title: "z.comがサービス終了するので（中略）スターサーバーと無料Googleサイトが最適だった話（後編）"
emoji: "🛬"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: [web]
published: true
---
## はじめに

スタードメインという今の私にピッタリなサービスを見つけたことでいよいよGWSでもお名前メールでも無くなってしまった本記事なのですが、一旦移行完了した時点で以下のようにいくつか課題が残っていました。

- Googleサイトに独自ドメインを設定する場合、「www」等（別の文字列でも）サブドメインである必要があるため、元々使っていたwww無しの〇〇.comから、wwwアリの方へリダイレクトなどの設定が必要になる。しかし上手くリダイレクトが設定できない。
- SSL証明書を有効にしていたはずなのだけどhttps://〇〇.com　でアクセスしても、上手くサイトが表示されずリダイレクトもなされない。


## リダイレクトについて

### 元から使っていたドメインをやめる

発想を転換しよう。よくよく最初はGoogleサイトへ紐づけるドメインは「www.～～～」の形が必須なのかと思っていたのですが、ある時wwwでなくても任意のサブドメインが設定できることに気づいた。（後述する書籍で理解が深まったのも一因。素晴らしい）

元から使っていたドメインは割と急造だったこともあり、さらにメールアドレスなどは別のドメインで作成していることから、そちらの今メインで使っているドメインのサブドメインを作成してそっちをGoogleサイトへ紐づけることで、スッキリさせることにした。

メールアドレスを設定していたドメインで別途Googleサイトを作成して紐づけておいて、元々のアドレスは、Googleサイトとの紐づけを解除して、スタードメインからリダイレクト設定をする、という形にする。これで問題なく前のアドレスが新サイトへ引き継がれるはず。
元々アクセスも少なかったので、あまりにない場合はドメインを管理する数を減らせるという点でもいずれ削除も視野に入れておくことにする。

違うサービスを考えた際に、そっちも本体のドメインのサブドメインって形でWEBサイトを追加できる点も魅力である。

### サブドメインの設定について
別のサービスも考えるパターンも想定して、GoogleサイトのURLは本体ドメインのサブドメインにすることにした。
スターサーバーの管理画面には「サブドメインの作成」のような項目もあるのだけど、サブドメインをGoogleサイト独自ドメインに設定するには、それは必要ない。シンプルにGoogleサイトの設定に従ってDNSレコード設定を追加していけば良い。
[こちらのサイト](https://www.value-domain.com/media/domain-usage-homepage/)が大変参考になった。

下記の書籍の知識を踏まえると、CNAME設定により、当該ドメインにアクセスした場合、Googleのサーバに対応するIPアドレスを読みに行くような設定になっていると理解された。素晴らしい本です。

## WEBページのSSLエラーについて

さて、上のGoogleサイトの設定は上手く行ったのですが、次はもともと使っていたドメインからGoogleサイトにつなげたドメインへの転送設定ができれば完了です。

しかしながらですね、スターサーバーデフォルト機能の転送設定では、http接続では問題なく転送されるのですが、https接続だと転送されません。というかサイトが表示されません。

スタードメインのSSLの有効化が反映されないのか？とか、私のやり方が間違っているのか？とか色々紆余曲折したのですが、結論、（どこかのタイミングでとち狂って）リダイレクトさせたいドメインのDNS設定を全削除していたのが原因でした。薄っすらそんなことをした記憶もなくはないのですが・・・あまり記憶がありません。怖いです。

ていうかDNSとかネームサーバーとか何もわかってなかったのでイマイチどこがどうなると良いのかわからんわからんとぐるぐる回っていたのですが、丁度近所の図書館で調べてみたらドンピシャな本[『Webサイト管理のきほん』](https://www.amazon.co.jp/dp/4297129221)を見つけまして、早速借りて読んでみたところDNSやWEBの全てを完全に理解することができました。他の本と比べたわけではないのですが私のようなWEBのブログとマニュアルで何とかやりたいことを実現してきたけど、全体として何がどうなっているのか・自分が何をしているのかをさっぱり理解していない人には大変ピッタリな本だと思いました。

というわけでその完全な理解をもとに設定をし直した‥‥というわけではなく、上記DNSが全部消えてたので無料サーバーを一回削除してもっかい作れば、なんかいい感じに初期設定されるんじゃね～？てなノリで削除・再作成したところ、上手いことDNS設定が行われまして、無事SSLも適用されました。

ただし、スターサーバーが提供してくれる転送設定だと、http://〇〇.comへのアクセスは問題なく転送してくれるのですが、これがhttpsになると上手くリダイレクトされません。困った。

## リダイレクトについて

しかし素晴らしい書籍でWEBのすべてを理解した私は、Apacheの設定ファイルについても理解したので、[こちらのブログ](https://meltingrabbit.com/blog/article/2018070501/)など「Apache　リダイレクト」などで検索してヒットする情報をもとに以下のように.htaccessファイルへリダイレクト設定を追記することで、無事リダイレクトさせることに成功したのでした。めでたしめでたし。

```
RewriteEngine On
RewriteCond %{HTTP_HOST} !^〇〇\.com$ [NC]
RewriteRule ^/(.*)$ https://転送先.com/$1 [R=301,L]
```

（2024年7月10日　早速追記）
↑の書き方ではやっぱりだめみたいでした。ていうか、結局スターサーバーのリダイレクト設定で上手く行ったのかもしれません。
[こちらのサイトなどを見ながら最後の最後ちゃんと理解する必要がありそうです。](https://www.itti.jp/web-design/htaccess-redirect/)

## おまけ　ブログについて

もともとはWordPressでブログ機能も使っていたのですが、Googleサイトにはブログはありません。しかし同じくGoogleのサービスで、なんと無料で独自ドメインも設定できる（すごい）Bloggerというサービスがありましたので、こちらにブログの内容は移行することにしました。

独自ドメインの設定も、設定画面から指示に従ってポチポチやれば完了します。

さらにSSLまで無料でやってくれます。

ただ問題は、元々のWordPressのブログをブラウザで表示して、その内容をBlogger投稿画面にコピペして、画像もそのままコピペされたので楽ちん楽ちんと思っていたところ、画像はリンクだけがコピーされていただけでZ.com サーバー終了に伴って全画像が消えてしまったのでした。悲しすぎる。

ローカルには画像はあるので、最後頑張って紐づければ本当に完了です。。。だるい。。。

## おわりに

だいぶ最後項目も雑になってきたのですが、最低限の目標も達成されたことで、一旦自分向け作業備忘記録としては終わりにします。
気が向けば適宜追記したり補足したり、文章整えたりします。以上！